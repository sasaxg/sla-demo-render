services:
  # 1. Node App
  - type: web
    name: node-app
    runtime: docker
    dockerfilePath: ./app/Dockerfile
    buildContext: ./app 
    plan: free
    envVars:
      - key: NODE_ENV
        value: production
    healthCheckPath: /health

  # 2. Prometheus
  - type: web
    name: prometheus
    runtime: docker
    dockerfilePath: ./prometheus/Dockerfile
    plan: free
    autoDeploy: true

  # 3. Alertmanager
  - type: web
    name: alertmanager
    runtime: docker
    dockerfilePath: ./alertmanager/Dockerfile
    plan: free
    envVars:
      - key: SMTP_SMART_HOST
        value: smtp.gmail.com:587
      - key: SMTP_FROM
        value: sasa270703@gmail.com
      - key: SMTP_AUTH_USERNAME
        value: sasa270703@gmail.com
      - key: SMTP_AUTH_PASSWORD
        value: dnlvfzwcwvwyiqwt
      - key: SMTP_REQUIRE_TLS
        value: "true"

  # 4. Blackbox Exporter
  - type: web
    name: blackbox
    runtime: docker
    dockerfilePath: ./blackbox/Dockerfile
    plan: free

  # 5. Grafana
  - type: web
    name: grafana
    runtime: docker
    dockerfilePath: ./grafana/Dockerfile
    plan: free
    envVars:
      - key: GF_SECURITY_ADMIN_USER
        value: admin
      - key: GF_SECURITY_ADMIN_PASSWORD
        value: admin123
